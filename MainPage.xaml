<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="MyCollectionMobileApp.MainPage"
             BackgroundColor="#f8fbfa"
             Title="Моя Коллекция">

    <!-- Главная сетка для разделения прокручиваемого контента и фиксированной навигации -->
    <Grid RowDefinitions="Auto,*,Auto">

        <!-- Секция вкладок с нижней границей -->
        <Border Grid.Row="0"
                Stroke="#d1e6d9"
                StrokeThickness="1"
                BackgroundColor="Transparent"
                Padding="0"
                Margin="0,0,0,12">
            <Grid ColumnDefinitions="Auto,Auto"
                  ColumnSpacing="32"
                  Padding="16,0,16,0">
                <!-- Активная вкладка Сетка -->
                <Border x:Name="GridTab"
                        Stroke="#38e07b"
                        StrokeThickness="3"
                        Padding="0,16,0,13"
                        BackgroundColor="Transparent"
                        Grid.Column="0">
                    <Label x:Name="GridLabel"
                           Text="Сетка"
                           TextColor="#0e1a13"
                           FontSize="14"
                           FontAttributes="Bold"
                           HorizontalOptions="Center"
                           VerticalOptions="Center">
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup Name="CommonStates">
                                <VisualState Name="Normal">
                                    <VisualState.Setters>
                                        <Setter Property="TextColor" Value="#0e1a13" />
                                        <Setter Property="Scale" Value="1" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState Name="PointerOver">
                                    <VisualState.Setters>
                                        <Setter Property="TextColor" Value="#38e07b" />
                                        <Setter Property="Scale" Value="1.05" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState Name="Pressed">
                                    <VisualState.Setters>
                                        <Setter Property="TextColor" Value="#51946c" />
                                        <Setter Property="Scale" Value="0.95" />
                                    </VisualState.Setters>
                                </VisualState>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                    </Label>
                    <Border.GestureRecognizers>
                        <TapGestureRecognizer Tapped="OnGridTabTapped" />
                    </Border.GestureRecognizers>
                </Border>

                <!-- Неактивная вкладка Список -->
                <Border x:Name="ListTab"
                        Stroke="Transparent"
                        StrokeThickness="3"
                        Padding="0,16,0,13"
                        BackgroundColor="Transparent"
                        Grid.Column="1">
                    <Label x:Name="ListLabel"
                           Text="Список"
                           TextColor="#51946c"
                           FontSize="14"
                           FontAttributes="Bold"
                           HorizontalOptions="Center"
                           VerticalOptions="Center">
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup Name="CommonStates">
                                <VisualState Name="Normal">
                                    <VisualState.Setters>
                                        <Setter Property="TextColor" Value="#51946c" />
                                        <Setter Property="Scale" Value="1" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState Name="PointerOver">
                                    <VisualState.Setters>
                                        <Setter Property="TextColor" Value="#38e07b" />
                                        <Setter Property="Scale" Value="1.05" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState Name="Pressed">
                                    <VisualState.Setters>
                                        <Setter Property="TextColor" Value="#0e1a13" />
                                        <Setter Property="Scale" Value="0.95" />
                                    </VisualState.Setters>
                                </VisualState>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                    </Label>
                    <Border.GestureRecognizers>
                        <TapGestureRecognizer Tapped="OnListTabTapped" />
                    </Border.GestureRecognizers>
                </Border>
            </Grid>
        </Border>

        <!-- Коллекция элементов -->
        <CollectionView Grid.Row="1"
                x:Name="ItemsCollectionView"
                ItemsSource="{Binding FilteredItems}"
                SelectionMode="None"
                Margin="16">

            <CollectionView.ItemsLayout>
                <GridItemsLayout Orientation="Vertical"
                                Span="2"
                                HorizontalItemSpacing="12"
                                VerticalItemSpacing="12"/>
            </CollectionView.ItemsLayout>

            <CollectionView.EmptyView>
                <StackLayout VerticalOptions="Center" HorizontalOptions="Center" Padding="40">
                    <Label Text="🎉" FontSize="48" HorizontalOptions="Center"/>
                    <Label Text="Ваша коллекция пуста" 
                           FontSize="18" 
                           TextColor="#51946c" 
                           HorizontalOptions="Center"
                           HorizontalTextAlignment="Center"/>
                    <Label Text="Нажмите '+' чтобы добавить первый элемент" 
                           FontSize="14" 
                           TextColor="#51946c" 
                           HorizontalOptions="Center"
                           HorizontalTextAlignment="Center"
                           Margin="0,10,0,0"/>
                </StackLayout>
            </CollectionView.EmptyView>

            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Frame Padding="0" 
                           BackgroundColor="Transparent"
                           BorderColor="Transparent">
                        <VerticalStackLayout Spacing="8">
                            <!-- Изображение элемента -->
                            <Image Source="{Binding ImagePath}" 
                                   Aspect="AspectFill"
                                   HeightRequest="150">
                                <Image.Clip>
                                    <RoundRectangleGeometry CornerRadius="8"
                                                           Rect="0,0,150,150" />
                                </Image.Clip>
                            </Image>

                            <!-- Название и информация -->
                            <VerticalStackLayout Spacing="4" Padding="8,0">
                                <Label Text="{Binding Name}" 
                                       TextColor="#0e1a13"
                                       FontSize="16"
                                       FontAttributes="Bold"
                                       MaxLines="1"
                                       LineBreakMode="TailTruncation"/>

                                <Label Text="{Binding Category}" 
                                       TextColor="#51946c"
                                       FontSize="12"
                                       MaxLines="1"/>

                                <Label Text="{Binding Cost, StringFormat='{0:C} руб.'}" 
                                       TextColor="#38e07b"
                                       FontSize="14"
                                       FontAttributes="Bold"/>
                            </VerticalStackLayout>
                        </VerticalStackLayout>

                        <Frame.GestureRecognizers>
                            <TapGestureRecognizer Tapped="OnItemTapped" />
                        </Frame.GestureRecognizers>
                    </Frame>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>

        <!-- Фиксированная нижняя панель навигации -->
        <VerticalStackLayout Grid.Row="2"
                             Spacing="0"
                             BackgroundColor="#f8fbfa">
            <Border Stroke="#e8f2ec"
                    StrokeThickness="1"
                    BackgroundColor="#f8fbfa"
                    Padding="16,8,16,12">
                <Grid ColumnDefinitions="*,*,*,*,*"
                      ColumnSpacing="8">
                    <!-- Домой (активная) -->
                    <VerticalStackLayout x:Name="HomeNav"
                                         Spacing="4"
                                         Grid.Column="0">
                        <Label x:Name="HomeLabel"
                               Text="🏠"
                               FontSize="24"
                               TextColor="#0e1a13"
                               HorizontalTextAlignment="Center">
                            <VisualStateManager.VisualStateGroups>
                                <VisualStateGroup Name="CommonStates">
                                    <VisualState Name="Normal">
                                        <VisualState.Setters>
                                            <Setter Property="TextColor" Value="#0e1a13" />
                                            <Setter Property="Scale" Value="1" />
                                        </VisualState.Setters>
                                    </VisualState>
                                    <VisualState Name="PointerOver">
                                        <VisualState.Setters>
                                            <Setter Property="TextColor" Value="#38e07b" />
                                            <Setter Property="Scale" Value="1.05" />
                                        </VisualState.Setters>
                                    </VisualState>
                                    <VisualState Name="Pressed">
                                        <VisualState.Setters>
                                            <Setter Property="TextColor" Value="#51946c" />
                                            <Setter Property="Scale" Value="0.95" />
                                        </VisualState.Setters>
                                    </VisualState>
                                </VisualStateGroup>
                            </VisualStateManager.VisualStateGroups>
                        </Label>
                        <Label Text="Главная"
                               TextColor="#0e1a13"
                               FontSize="12"
                               FontAttributes="Bold"
                               HorizontalTextAlignment="Center" />
                        <VerticalStackLayout.GestureRecognizers>
                            <TapGestureRecognizer Tapped="OnHomeNavTapped" />
                        </VerticalStackLayout.GestureRecognizers>
                    </VerticalStackLayout>

                    <!-- Добавить -->
                    <VerticalStackLayout x:Name="AddItemNav"
                                         Spacing="4"
                                         Grid.Column="1">
                        <Label x:Name="AddItemLabel"
                               Text="➕"
                               FontSize="24"
                               TextColor="#51946c"
                               HorizontalTextAlignment="Center">
                            <VisualStateManager.VisualStateGroups>
                                <VisualStateGroup Name="CommonStates">
                                    <VisualState Name="Normal">
                                        <VisualState.Setters>
                                            <Setter Property="TextColor" Value="#51946c" />
                                            <Setter Property="Scale" Value="1" />
                                        </VisualState.Setters>
                                    </VisualState>
                                    <VisualState Name="PointerOver">
                                        <VisualState.Setters>
                                            <Setter Property="TextColor" Value="#38e07b" />
                                            <Setter Property="Scale" Value="1.05" />
                                        </VisualState.Setters>
                                    </VisualState>
                                    <VisualState Name="Pressed">
                                        <VisualState.Setters>
                                            <Setter Property="TextColor" Value="#0e1a13" />
                                            <Setter Property="Scale" Value="0.95" />
                                        </VisualState.Setters>
                                    </VisualState>
                                </VisualStateGroup>
                            </VisualStateManager.VisualStateGroups>
                        </Label>
                        <Label Text="Добавить"
                               TextColor="#51946c"
                               FontSize="12"
                               FontAttributes="Bold"
                               HorizontalTextAlignment="Center" />
                        <VerticalStackLayout.GestureRecognizers>
                            <TapGestureRecognizer Tapped="OnAddItemNavTapped" />
                        </VerticalStackLayout.GestureRecognizers>
                    </VerticalStackLayout>

                    <!-- Фильтры -->
                    <VerticalStackLayout x:Name="FiltersNav"
                                         Spacing="4"
                                         Grid.Column="2">
                        <Label x:Name="FiltersLabel"
                               Text="🔧"
                               FontSize="24"
                               TextColor="#51946c"
                               HorizontalTextAlignment="Center">
                            <VisualStateManager.VisualStateGroups>
                                <VisualStateGroup Name="CommonStates">
                                    <VisualState Name="Normal">
                                        <VisualState.Setters>
                                            <Setter Property="TextColor" Value="#51946c" />
                                            <Setter Property="Scale" Value="1" />
                                        </VisualState.Setters>
                                    </VisualState>
                                    <VisualState Name="PointerOver">
                                        <VisualState.Setters>
                                            <Setter Property="TextColor" Value="#38e07b" />
                                            <Setter Property="Scale" Value="1.05" />
                                        </VisualState.Setters>
                                    </VisualState>
                                    <VisualState Name="Pressed">
                                        <VisualState.Setters>
                                            <Setter Property="TextColor" Value="#0e1a13" />
                                            <Setter Property="Scale" Value="0.95" />
                                        </VisualState.Setters>
                                    </VisualState>
                                </VisualStateGroup>
                            </VisualStateManager.VisualStateGroups>
                        </Label>
                        <Label Text="Фильтры"
                               TextColor="#51946c"
                               FontSize="12"
                               FontAttributes="Bold"
                               HorizontalTextAlignment="Center" />
                        <VerticalStackLayout.GestureRecognizers>
                            <TapGestureRecognizer Tapped="OnFiltersNavTapped" />
                        </VerticalStackLayout.GestureRecognizers>
                    </VerticalStackLayout>

                    <!-- Статистика -->
                    <VerticalStackLayout x:Name="StatsNav"
                                         Spacing="4"
                                         Grid.Column="3">
                        <Label x:Name="StatsLabel"
                               Text="📊"
                               FontSize="24"
                               TextColor="#51946c"
                               HorizontalTextAlignment="Center">
                            <VisualStateManager.VisualStateGroups>
                                <VisualStateGroup Name="CommonStates">
                                    <VisualState Name="Normal">
                                        <VisualState.Setters>
                                            <Setter Property="TextColor" Value="#51946c" />
                                            <Setter Property="Scale" Value="1" />
                                        </VisualState.Setters>
                                    </VisualState>
                                    <VisualState Name="PointerOver">
                                        <VisualState.Setters>
                                            <Setter Property="TextColor" Value="#38e07b" />
                                            <Setter Property="Scale" Value="1.05" />
                                        </VisualState.Setters>
                                    </VisualState>
                                    <VisualState Name="Pressed">
                                        <VisualState.Setters>
                                            <Setter Property="TextColor" Value="#0e1a13" />
                                            <Setter Property="Scale" Value="0.95" />
                                        </VisualState.Setters>
                                    </VisualState>
                                </VisualStateGroup>
                            </VisualStateManager.VisualStateGroups>
                        </Label>
                        <Label Text="Статистика"
                               TextColor="#51946c"
                               FontSize="12"
                               FontAttributes="Bold"
                               HorizontalTextAlignment="Center" />
                        <VerticalStackLayout.GestureRecognizers>
                            <TapGestureRecognizer Tapped="OnStatsNavTapped" />
                        </VerticalStackLayout.GestureRecognizers>
                    </VerticalStackLayout>

                    <!-- Настройки -->
                    <VerticalStackLayout x:Name="SettingsNav"
                                         Spacing="4"
                                         Grid.Column="4">
                        <Label x:Name="SettingsLabel"
                               Text="⚙️"
                               FontSize="24"
                               TextColor="#51946c"
                               HorizontalTextAlignment="Center">
                            <VisualStateManager.VisualStateGroups>
                                <VisualStateGroup Name="CommonStates">
                                    <VisualState Name="Normal">
                                        <VisualState.Setters>
                                            <Setter Property="TextColor" Value="#51946c" />
                                            <Setter Property="Scale" Value="1" />
                                        </VisualState.Setters>
                                    </VisualState>
                                    <VisualState Name="PointerOver">
                                        <VisualState.Setters>
                                            <Setter Property="TextColor" Value="#38e07b" />
                                            <Setter Property="Scale" Value="1.05" />
                                        </VisualState.Setters>
                                    </VisualState>
                                    <VisualState Name="Pressed">
                                        <VisualState.Setters>
                                            <Setter Property="TextColor" Value="#0e1a13" />
                                            <Setter Property="Scale" Value="0.95" />
                                        </VisualState.Setters>
                                    </VisualState>
                                </VisualStateGroup>
                            </VisualStateManager.VisualStateGroups>
                        </Label>
                        <Label Text="Настройки"
                               TextColor="#51946c"
                               FontSize="12"
                               FontAttributes="Bold"
                               HorizontalTextAlignment="Center" />
                        <VerticalStackLayout.GestureRecognizers>
                            <TapGestureRecognizer Tapped="OnSettingsNavTapped" />
                        </VerticalStackLayout.GestureRecognizers>
                    </VerticalStackLayout>
                </Grid>
            </Border>

            <!-- Нижняя область для безопасной зоны -->
            <BoxView HeightRequest="20"
                     BackgroundColor="#f8fbfa" />
        </VerticalStackLayout>
    </Grid>
</ContentPage>